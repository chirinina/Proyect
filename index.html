<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Esam Sucre Sucursal</title>
    <style>
      /* RESETEO B√ÅSICO */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: Arial, sans-serif;
        background-color: #f0f0f0;
      }
      h1,
      h2,
      h3,
      h4,
      p {
        margin: 0.5em 0;
      }
      
      /* CONTENEDOR DEL MAIN (Generador y Documentos) */
      .main-container {
        display: none;
      }
      
      .btn {
        display: inline-block;
        margin: 10px 5px 0 0;
        padding: 10px 20px;
        /* background: #0066cc; */
        color: #fff;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
      }
      .btn:hover {
        /* background: #004999; */
      }
      .hidden {
        display: none;
      }
      /* Mensaje de proceso */
      #procesoMensaje {
        text-align: center;
        font-size: 18px;
        color: #555;
        margin-top: 20px;
      }
      /* BOTONES DE ACCI√ìN (Ver, Descargar, Compartir, Historial) */
      .action-container {
        width: 90%;
        max-width: 600px;
        margin: 20px auto;
        text-align: center;
      }
      /* CONTENEDOR DEL HISTORIAL */
      .history-container {
        width: 90%;
        max-width: 600px;
        margin: 20px auto;
        background: #fff;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        display: none;
      }
      .history-container h2 {
        text-align: center;
        margin-bottom: 15px;
      }
      .history-item {
        border-bottom: 1px solid #ccc;
        padding: 10px 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .history-item:last-child {
        border-bottom: none;
      }
      /* DOCUMENTO GENERADO (P√°ginas) */
      #documento {
        display: none;
      }
      
    </style>
  </head>
  <body>


    <style>
      /* Reset Moderno */
      *, *::before, *::after {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
          /* font-family: 'Inter', system-ui, -apple-system, sans-serif; */
      }
      
      body {
          display: flex;
          min-height: 100vh;
          background: #d5e4f3;
          padding: 1rem;
      }
      
      .login-container {
          display: flex;
          width: 100%;
          max-width: 900px;
          margin: auto;
          background: white;
          border-radius: 1.5rem;
          box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
          overflow: hidden;
          animation: slideIn 0.6s cubic-bezier(0.23, 1, 0.32, 1);
      }
      
      @keyframes slideIn {
          from { opacity: 0; transform: translateY(20px); }
          to { opacity: 1; transform: translateY(0); }
      }
      
      .login-form {
          flex: 1;
          padding: 6rem;
          min-width: 400px;
      }
      
      .login-image {
          flex: 1;
          background: linear-gradient(45deg, #4f46e5, #6366f1);
          position: relative;
          overflow: hidden;
      }
      
      .login-image img {
          width: 100%;
          height: 100%;
          object-fit: cover;
          opacity: 0.9;
      }
      
      .login-image::after {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: linear-gradient(45deg, rgba(79, 70, 229, 0.9), rgba(99, 102, 241, 0.2));
      }
      
      .image-content {
          position: absolute;
          bottom: 2rem;
          left: 2rem;
          z-index: 1;
          color: white;
      }
      
      .image-content h2 {
          font-size: 1.75rem;
          margin-bottom: 0.5rem;
      }
      
      .image-content p {
          font-size: 0.9rem;
          opacity: 0.9;
      }
      
      .login-container h1 {
          color: #1e293b;
          font-size: 1.75rem;
          font-weight: 600;
          margin-bottom: 2.5rem;
          text-align: center;
      }
      
      .login-container input {
          width: 60%;
          padding: 0.875rem 1.25rem;
          margin-bottom: 1.5rem;
          border: 1px solid #e2e8f0;
          border-radius: 0.75rem;
          font-size: 0.9375rem;
          transition: all 0.2s ease;
          /* background: #4c6d85; */
      }
      
      .login-container input:focus {
          outline: none;
          border-color: #4f46e5;
          box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
          background: white;
      }
      
      .btn {
          /* width: 100%; */
          padding: 0.875rem;
          background: #0a0652;
          color: white;
          border: none;
          border-radius: 0.75rem;
          font-size: 0.9375rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s ease;
      }
      
      .btn:hover {
          background: #040122;
          transform: translateY(-1px);
      }
      
      @media (max-width: 768px) {
          .login-image {
              display: none;
          }
          
          .login-form {
              min-width: auto;
              padding: 2rem;
          }
      }
      
      @media (max-width: 480px) {
          .login-container {
              border-radius: 1rem;
          }
          
          .login-form {
              padding: 1.5rem;
          }
          
          .login-container h1 {
              font-size: 1.5rem;
          }
      }
      </style>
      
      <div class="login-container" id="loginContainer">
          <!-- Formulario de login -->
          <div class="login-form">
            <h1>Iniciar Sesi√≥n</h1>
            <input type="text" id="username" placeholder="Usuario" />
            <input type="password" id="password" placeholder="Contrase√±a" />
            <span onclick="togglePassword()">
                <i class="fas fa-eye"></i> <!-- Icono de ojo de Font Awesome -->
            </span>
            <button class="btn" id="btnLogin">Ingresar</button>
            <!-- Mensaje de error (si se desea, se puede mantener o eliminar) -->
            <p id="error-message" style="color: red; display: none; margin-top: 10px;"></p>
        </div>
          <!-- Formulario de login -->

          <script>
            function togglePassword() {
                const passwordInput = document.getElementById("password");
                const icon = document.querySelector("span i");
                
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    icon.classList.remove("fa-eye");
                    icon.classList.add("fa-eye-slash"); // Cambia el icono a "ojo tachado"
                } else {
                    passwordInput.type = "password";
                    icon.classList.remove("fa-eye-slash");
                    icon.classList.add("fa-eye"); // Cambia al icono de "ojo"
                }
            }
        </script>
        <script>
            // LOGIN
            const btnLogin = document.getElementById("btnLogin");
            const errorMessage = document.getElementById("error-message");
            const usernameField = document.getElementById("username");
            const passwordField = document.getElementById("password");

            btnLogin.addEventListener("click", () => {
                const user = usernameField.value;
                const pass = passwordField.value;
        
                // Restablecer el color de los campos
                usernameField.style.borderColor = "";
                passwordField.style.borderColor = "";
        
                // Usuarios v√°lidos
                if (
                    (user === "usuario1" && pass === "pass1") ||
                    (user === "admi" && pass === "admi123") ||
                    (user === "jquintanacutipa" && pass === "10381927Ch") ||
                    (user === "usuario1" && pass === "usuario1") ||
                    (user === "usuario2" && pass === "pass2")
                ) {
                    document.getElementById("loginContainer").style.display = "none";
                    document.getElementById("mainContainer").style.display = "block";
                    errorMessage.style.display = "none"; // Oculta el mensaje de error si el login es correcto
                } else {
                    // Cambiar el borde de los campos a rojo si las credenciales son incorrectas
                    usernameField.style.borderColor = "red";
                    passwordField.style.borderColor = "red";
                    
                    // Mostrar el mensaje de error debajo del formulario (opcional)
                    errorMessage.textContent = "Estoy Trabajando dejame chambear....ü§£üòú";
                    errorMessage.style.display = "block";
                }
            });
        </script>
        
          
          <!-- Secci√≥n de Imagen -->
          <div class="login-image">
              <img src="https://images.unsplash.com/photo-1553877522-43269d4ea984?auto=format&fit=crop&w=1200&q=80" alt="Modern workspace">
              <div class="image-content">
                  <h2>Bienvenido a Esam</h2>
                  <p>Accede a tu cuenta para generar nueva carta</p>
              </div>
          </div>
      </div>


    <style>
      :root {
      --primary-color: #1d0555;
      --secondary-color: #010233;
      --text-color: #2c3e50;
      --bg-color: #f8f9fa;
      --transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    /* Estructura Principal Responsiva */
    .main-container {
      padding: 1rem;
      max-width: 1600px;
      margin: 0 auto;
    }

    .form-container {
      
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      
      /* box-shadow: 0 12px 24px rgba(0,0,0,0.08); */
      animation: containerScale 0.6s ease;
    }

    @keyframes containerScale {
      0% { transform: scale(0.98); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }

    /* Grupos de Formulario Animados */
    .form-group {
      display: flex;
      flex-direction: column;
      margin-bottom: 1.2rem;
      animation: slideIn 0.6s ease forwards;
      opacity: 0;
    }

    @keyframes slideIn {
      from { transform: translateX(-30px); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .form-group:nth-child(1) { animation-delay: 0.1s; }
    .form-group:nth-child(2) { animation-delay: 0.2s; }
    .form-group:nth-child(3) { animation-delay: 0.3s; }

    /* Elementos de Formulario Mejorados */
    input, textarea {
      width: 70%;
      padding: 0.8rem;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 0.95rem;
      transition: var(--transition);
      background: rgba(255,255,255,0.95);
    }

    input:focus, textarea:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 15px rgba(52,152,219,0.2);
      transform: translateY(-2px);
    }

    textarea {
      min-height: 100px;
      resize: vertical;
    }

    /* Bot√≥n Inteligente con Animaci√≥n */
    .btn {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      padding: 0.8rem 2rem;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: var(--transition);
      grid-column: 1 / -1;
      justify-self: center;
      box-shadow: 0 5px 15px rgba(52,152,219,0.3);
      position: relative;
      overflow: hidden;
    }

    .btn::after {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: rgba(255,255,255,0.1);
      transform: rotate(45deg);
      transition: var(--transition);
    }

    .btn:hover::after {
      left: 50%;
      top: 50%;
    }

    .btn:active {
      transform: scale(0.98);
    }

    /* Secci√≥n de Fechas Din√°mica */
    #fechasContainer {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 1rem;
      margin-top: 1.2rem;
    }

    /* Loader Moderno */
    .loader {
      width: 22px;
      height: 22px;
      border: 3px solid #f3f3f3;
      border-top: 3px solid var(--primary-color);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Mensaje de Proceso */
    #procesoMensaje {
      text-align: center;
      padding: 1rem;
      background: rgba(52,152,219,0.05);
      border-radius: 8px;
      margin-top: 1.5rem;
      animation: fadeIn 0.4s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Responsive Design Avanzado */
    @media (max-width: 768px) {
      .form-container {
        grid-template-columns: 1fr;
        padding: 1.5rem;
      }
      
      .form-group {
        margin-bottom: 1rem;
      }
      
      input, textarea {
        font-size: 0.9rem;
        padding: 0.7rem;
      }
      
      .btn {
        /* width: 100%; */
        padding: 0.8rem;
      }
    }

    @media (max-width: 480px) {
      .main-container {
        padding: 0.5rem;
      }
      
      .form-container {
        border-radius: 12px;
        padding: 1rem;
      }
      
      #fechasContainer {
        grid-template-columns: 1fr;
      }
    }

    /* Animaciones Adicionales */
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }

    input:hover {
      animation: float 3s ease-in-out infinite;
    }

    /* Mejoras de Accesibilidad */
    label {
      font-size: 0.9rem;
      color: var(--text-color);
      margin-bottom: 0.5rem;
      font-weight: 500;
      font-family: Arial, sans-serif;
      font-style: italic;
      transition: color 0.2s ease;
    }

    .form-group:focus-within label {
      color: var(--primary-color);
    }
    @media print {
    /* Mantener bordes de tablas */
    table, th, td {
        border: 1px solid #000 !important;
        border-collapse: collapse !important;
    }
    
    /* Ajustar m√°rgenes para impresi√≥n */
    @page {
        margin: 0cm;
    }
    
    /* Ocultar bot√≥n de descarga en el PDF */
    #btnDescargarShared {
        display: none !important;
    }
    
    /* Mantener sombras y bordes del documento */
    .page {
        /* box-shadow: none !important; */
        /* margin: 0 auto !important; */
    }
}
    </style>
<!-- Bot√≥n flotante para descarga -->
<button 
    id="btnDescargarShared"
    class="hidden"
    style="
        position: fixed;
        bottom: 10px;
        right: 10px;
        background: none;
        padding: 14px;
        border: none;
        cursor: pointer;
        z-index: 1000;
        color: #06047c;  /* Azul intenso */
        transition: all 0.3s ease;
    ">
    <svg 
        style="
            width: 36px;
            height: 36px;
            animation: pulse 1.5s ease-in-out infinite;" 
        viewBox="0 0 24 24" 
        fill="none" 
        stroke="currentColor" 
        stroke-width="3"
        stroke-linecap="round" 
        stroke-linejoin="round">
        <path d="M8 17l4 4 4-4"/>
        <path d="M12 12v9"/>
        <path d="M20.88 18.09A5 5 0 0 0 18 9h-1.26A7 7 0 1 0 12 21"/>
    </svg>
</button>
<style>
    @keyframes pulse {
        0%, 100% { transform: translateY(0) scale(1); }
        50% { transform: translateY(-5px) scale(1.05); }
    }
    #btnDescargarShared:hover {
        color: #fa7900;  /* Azul m√°s oscuro al hover */
        background: rgba(241, 241, 241);
    }
    #btnDescargarShared:active {
        transform: scale(0.92);
    }
</style>
    <!-- MAIN: Generador y Documentos (Se muestra luego del login) -->
    <div class="main-container" id="mainContainer">
      <!-- FORMULARIO MODERNO -->
      <div class="form-container" id="formulario">
        <h1>Generador de plantillas Esam</h1>
        <p>
          Completa los campos y presiona <strong>PROCESAR</strong>. Luego se
          generara la carta.
        </p><br>
          <!-- Bot√≥n PROCESAR -->
        <button class="btn" id="btnProcesar">PROCESAR</button><p id="procesoMensaje" class="hidden">
          <span class="loader" style="color:#19066e"></span>Procesando.....
        </p>
        <div class="form-group">
          <label for="inputMscName">Msc. XX (Docente..)</label>
          <input
            type="text"
            id="inputMscName"
            placeholder="Ej: Msc. Juan P√©rez"
          />
        </div>
        <div class="form-group">
          <label for="inputDiplomado">Diplomado en:...</label>
          <input
            type="text"
            id="inputDiplomado"
            placeholder="Ej: Diplomado en gestion"
          />
        </div>

        <!-- P√°gina 2: Datos de la segunda hoja -->
        <div class="form-group">
          <label for="inputModulo">Modulo (T√≠tulo)</label>
          <input
            type="text"
            id="inputModulo"
            placeholder="Ej: Modulo de proyectos"
          />
        </div>
        <div class="form-group">
          <label for="inputNumeroModulo"
            >N√∫mero de M√≥dulo (I, II, III...)</label
          >
          <input type="text" id="inputNumeroModulo" placeholder="Ej: Modulo I" />
        </div>
        <div class="form-group">
          <label for="inputContenido">Contenido</label>
          <textarea
            id="inputContenido"
            placeholder="Contenido m√≠nimo sugerido..."
          ></textarea>
        </div>
        <div class="form-group">
          <label for="inputFechas">Fecha de clases</label>
          <input
            id="inputFechas"
            class="form-control"
            placeholder="Opcional..."
            value=""
          />
        </div>
        
        
      
        <!-- P√°gina 3: 10 Fechas de entrega -->
        <div class="form-group">
          <h2>Fechas Entrega</h2>
          <div id="fechasContainer"></div>
        </div>

      <!-- Aseg√∫rate de incluir FontAwesome o usa un √≠cono que prefieras -->
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

      <style>
        /* Contenedor para la animaci√≥n */
        #procesoMensaje {
          display: flex;
          align-items: center;
          font-family: Arial, sans-serif;
          font-size: 18px;
          color: #333;
        }

        /* Espacio entre el icono y el texto */
        .loader {
          width: 24px;
          height: 24px;
          border: 3px solid #f3f3f3;
          border-top: 3px solid #3498db;
          border-radius: 50%;
          margin-right: 10px;
          animation: spin 1.5s linear infinite;
        }

        /* Animaci√≥n de rotaci√≥n */
        @keyframes spin {
          0% {
            transform: rotate(0deg);
          }
          100% {
            transform: rotate(360deg);
          }
        }

        /* Efecto de desvanecimiento para la transici√≥n */
        .hidden {
          opacity: 0;
          transition: opacity 0.3s ease-in-out;
        }

        .visible {
          opacity: 1;
        }
      </style>
        </div>
        <!-- Botones de acci√≥n (Ver, Descargar, Compartir, Historial) -->
      <div class="action-container hidden" id="botones-acciones">
        <button class="btn" id="btnVer">
          <i data-lucide="eye"  style="color: #ff7301;"></i> 
        </button>
        <button class="btn" id="btnDescargar">
          <i data-lucide="download"  style="color: #0609be;"></i> 
        </button>
        <button class="btn" id="btnCompartir">
          <i data-lucide="share-2" style="color: #05976b;"></i>
        </button>
        <button class="btn" id="btnHistorial">
          <i data-lucide="history"  style="color: #e0dd03;"></i>
        </button>
        <button class="btn" id="btnCorreo">
          <i data-lucide="mail" style="color: #ff0000;"></i>
        </button>
      </div>
      <!-- Formulario flotante para correo -->
<div id="emailForm" class="hidden" style="
position: absolute;
background: white;
padding: 15px;
border-radius: 8px;
box-shadow: 0 2px 10px rgba(0,0,0,0.1);
z-index: 1000;
margin-top: 10px;
">
<input 
    type="email" 
    id="emailInput" 
    placeholder="Correo del destinatario"
    style="
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        margin-bottom: 8px;
        width: 100%;
">
<div style="display: flex; gap: 8px;">
    <button 
        type="button"
        onclick="enviarCorreo()"
        style="
            padding: 8px 15px;
            background: #0a0652;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
    ">
        Enviar
    </button>
    <button 
        type="button" 
        onclick="document.getElementById('emailForm').classList.add('hidden')"
        style="
            padding: 8px 15px;
            background: #666;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
    ">
        Cancelar
    </button>
</div>
</div>
        <!-- HISTORIAL DE DOCUMENTOS -->
      <div class="history-container hidden" id="historyContainer">
          <h2>Historial de Documentos Generados</h2>
          <div id="historyList"></div>
          <button class="btn" id="btnCerrarHistorial">Cerrar Historial</button>
      </div>
      <style>
          .page {
        position: relative;
        width: 210mm; /* A4 */
        min-height: 297mm; /* A4 */
        margin: 20px auto;
        background: #fff;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        page-break-after: always;
        padding: 0;
        border: 1px solid black; /* Borde delgado de color negro */
        } 

          /* P√°gina 1 con barra izquierda */
          .page1 .left-column {
            position: absolute;
            top: 0;
            left: 0;
            width: 48mm;
            height: 100%;
            background: #071e3b;
            /* padding: 20px; */
            text-align: center;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
          }
          .page1 .left-column img {
            max-width: 50%;
            height: auto;
            margin-bottom: 35px;
          }
          .page1 .left-column p {
            color: #fff;
            font-size: 0.7em;
            margin-top: 750px;
            line-height: 1.3em;
            text-align: center;  /* Centrado del texto */
            padding-bottom: 10px;  /* Espacio entre el texto y la l√≠nea */
            position: relative; /* Necesario para colocar el pseudo-elemento */
          }

          .page1 .left-column p::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 100%;
            height: 3px;  /* Altura de la l√≠nea */
            background: linear-gradient(to right, #021d92, #ff0800, #f10000); /* Degradado */
          }
          .page1 .right-column {
            margin-left: 48mm;
            padding: 30px 20px;
          }
          /* P√°ginas 2 y 3 (ancho completo) */
          .full-content {
            width: 100%;
            padding: 30px 20px;
          }
          .page1-content p,
          .page2-content p,
          .page3-content p {
            text-align: justify;
            font-family: Arial, Helvetica, sans-serif;
            margin-bottom: 10px;
          }
          .page2-content table,
          .page3-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
          }
          .page3-content table,
          .page3-content th,
          .page3-content td {
            border: 1px solid #000;
          }
          .page3-content th,
          .page3-content td {
            padding: 5px;
            text-align: left;
            vertical-align: top;
          }
          .data-field {
            font-weight: bold;
            color: #000;
          }
          /* IMPRESI√ìN: Se ocultan formulario, botones y historial */
          @media print {
            .form-container,
            .action-container,
            .history-container {
              display: none !important;
            }
            body {
              background: #fff;
            }
            * {
              -webkit-print-color-adjust: exact;
              print-color-adjust: exact;
            }
          }
          .history-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
          }
          @media print {
    /* RESTAURAR BORDES DE TABLAS */
    table {
        border: 1px solid #000 !important;
        border-collapse: collapse !important;
        width: 100% !important;
    }
    
    th, td {
        border: 1px solid #000 !important;
        padding: 8px !important;
        text-align: left !important;
    }
    
    /* AJUSTES FINALES DE DISE√ëO */
    .page {
        margin: 0 auto !important;
        border: none !important;
    }
    
    @page {
        margin: 1cm;
    }
    
    /* OCULTAR BOT√ìN EN PDF */
    #btnDescargarShared {
        display: none !important;
    }
}
      </style>

        <!--DOCUMENTO GENERADO-->
        <div id="documento">
        <!-- P√°gina 1: Con barra izquierda -->
        <div class="page page1">
          <div class="left-column">
            <div style="position: relative; margin-bottom: 10px;">
              <!-- L√≠nea degradada m√°s larga y centrada -->
              <div style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%); width: 128%; height: 20px; background: linear-gradient(to right, #020463, #eb1203);"></div>
              
              <!-- Im√°genes -->
              <img src="https://www.esam.edu.bo/img/logo_unsxx.png" alt="Logo SXX" />
              <img src="https://www.esam.edu.bo/img/logo_esam_principal.png" alt="Logo esam" />
          </div>
            <p>
              <strong style="display: block; text-align: center; position: relative;">SUCURSAL
              <span style="display: block; width: 150px; height: 2px; margin: 10px auto 0; background: linear-gradient(to right, #020463, #eb1203);"></span>
            </strong>
            <br>
              Calle Sucre #976<br />
              FENTE A ENTEL<br/>
              <strong>Escuela de Negocios</strong><br>
              ESAM MONTEAGUDO<br>
              <strong>www.esam.edu.bo</strong>
            </p>
          </div>
          <div class="right-column page1-content">
            <p id="fechaActual" style="text-align: right"></p>
            <br/>
            <p><strong>Se√±or/a:</strong></p>
            <p>
              <span id="mscNameOutput" class="data-field">MSC. XX</span><br />
              Presente. -
            </p>
            <p><strong>Ref.: INVITACI√ìN</strong></p>
            <p>Estimado docente:</p>
            <p>
              Ante todo, reciba el m√°s cordial de los saludos y deseos de √©xito
              en las labores que desempe√±a en bien del desarrollo de nuestro
              pa√≠s, conocedores de su amplia experiencia y conocimiento, nos
              permitimos hacerle la presente invitaci√≥n para que pueda formar
              parte de nuestro selecto plantel docente del programa de
              <span id="diplomadoOutput" class="data-field"
                >DIPLOMADO EN XX</span
              >, de esa manera pueda compartir sus conocimientos y experiencias
              con los participantes del mencionado programa, a trav√©s de la
              Escuela de Negocios ‚ÄúESAM‚Äù.
            </p>
            <p>
              La ESAM est√° avalada bajo el Convenio con la Universidad Nacional
              Siglo XX del Estado Plurinacional de Bolivia y cuenta con una
              estructura administrativa a nivel nacional, por lo cual se
              encuentra en la capacidad administrativa y acad√©mica para ofertar
              y desarrollar variados programas de formaci√≥n profesional
              complementaria.
            </p>
            <p>
              Seguros de contar con su valiosa participaci√≥n, nos despedimos con
              las consideraciones m√°s distinguidas.
            </p>
            <br />
            <div style="position: relative; display: flex; justify-content: space-between; align-items: center; margin-top: 80px;">

              <!-- Firma Izquierda -->
              <div style="text-align: center; width: 45%; margin-top: 30px;"><br><br><br><br>
                <p style="margin: 0; font-size: 14px; line-height: 1.8;">
                  <strong><em>Ing. Juan Gustavo Quintana Cutipa</em></strong><br />
                  <div style="color: #000000; text-align: center;">
                    <strong><em>PROYECTISTA</em></strong><br />
                    <strong><em>ESAM MONTEAGUDO</em></strong><br />
                    <em>72947133</em>
                  </div>
                </p>
              </div>
            
              <!-- Firma Derecha -->
              <div style="text-align: center; width: 45%; margin-top: 30px;"><br><br><br><br>
                <p style="margin: 0; font-size: 14px; line-height: 1.8;">
                  <strong><em>Ing. Andrea Luc√≠a Aramayo Mart√≠nez</em></strong><br />
                  <div style="color: #000000; text-align: center;">
                    <strong><em>COORDINADORA ACAD√âMICA</em></strong><br />
                    <strong><em>ESAM MONTEAGUDO</em></strong><br />
                    <em>73360695</em>
                  </div>
                </p>
              </div>
            
              <!-- Sello flotante m√°s grande -->
              <img src="https://i.ibb.co/j2B0MBm/cello-final.png" alt="cello-final" 
                   style="position: absolute; top: -50px; left: 50%; transform: translateX(-50%); width: 152px;">
            </div>            
          </div>
        </div>

        <!-- P√°gina 2: Sin barra izquierda -->
        <div class="page page2">
          <div class="full-content page2-content">
            <h3>
              <span id="diplomadoOutput2" class="data-field"
                >DIPLOMADO EN XX</span>
              ‚Äì ESAM MONTEAGUNDO
            </h3>
            <table border="1" cellspacing="0" cellpadding="5" style="width: 100%; border-collapse: collapse; text-align: center; font-family: Arial, sans-serif;">
              <thead style="background-color: #1f3a68; color: white;">
                <tr>
                  <th>M√ìDULO</th>
                  <th>CONTENIDO M√çNIMO SUGERIDO</th>
                  <th>FECHAS DE<br>CLASES VIRTUALES</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td style="vertical-align: top; padding: 15px;">
                    <strong>
                      <span id="numeroModuloOutput" class="data-field"></span>
                    </strong>
                    <p>
                      <strong >M√ìDULO:</strong>
                      <span id="moduloOutput" class="data-field">---</span>
                    </p>
                  </td>
                  <td style="vertical-align: top; padding: 15px; text-align: left;">
                    <!-- <strong>CONTENIDO M√çNIMO SUGERIDO:</strong><br> -->
                    <ul style="padding-left: 20px; margin: 0;">
                      <li><span id="contenidoOutput" class="data-field"></span></li>
                    </ul>
                  </td>
                  <td style="vertical-align: middle; padding: 15px; text-align: center;">
                    <span id="fechasOutput" class="data-field">---</span><br>
                    <strong>19:00 PM<br>
                    A<br>
                    22:00 PM<br><br></strong>
                    (4 CLASES)<br>
                    CADA UNA <br> DE 3 HORAS<br><br><br><strong>
                    El cronograma de clases se <br> gestionar√° con la <br> coordinadora acad√©mica
                    <br><br><br></strong>
                  </td>
                  
                </tr>
              </tbody>
            </table><br><br>
            
            <p><strong>
              ES PRECISO QUE ANTES DEL INICIO DE M√ìDULO CARGUE A PLATAFORMA EL
              PLAN ACAD√âMICO CURRICULAR MISMO QUE DEBE SER ENVIADO EN PDF
              DEBIDAMENTE LLENADO Y FIRMADO A COORDINACI√ìN ACAD√âMICA</strong>
            </p>
            <p>
              LINK DE DESCARGA.<br />
              <a
                href="https://drive.google.com/drive/folders/1PQ8TY-lfSIL87QQ_SWjmwGUiRFPj_NZ0?usp=sharing"
                target="_blank">
                https://drive.google.com/drive/folders/1PQ8TY-lfSIL87QQ_SWjmwGUiRFPj_NZ0?usp=sharing
              </a>
            </p><br><br>
            <p><strong>OBJETIVO:</strong></p>
            <p></p><br><br>
            <p><strong>BIBLIOGRAF√çA:</strong></p>
            
              <ul style="list-style-position: inside; padding-left: 0; margin-left: 0;">
                <li style="text-indent: 0; line-height: 1.5;">Comit√© Ejecutivo de la Universidad Boliviana [CEUB]. (2011). 
                  Reglamento General de Estudios de Postgrado de la Universidad Boliviana. La Paz, Bolivia.</li>
                <li style="text-indent: 0; line-height: 1.5;">Reglamento del Sistema Nacional de Estudios de Posgrado de la 
                  Universidad Boliviana. (2015). Comit√© Ejecutivo de la Universidad Boliviana. 
                  Secretar√≠a Nacional de Posgrado y Educaci√≥n Continua. La Paz ‚Äì Bolivia.</li>
              </ul>   
          </div>
        </div>

        <!-- P√°gina 3: Sin barra izquierda -->
        <div class="page page3">
          <div class="full-content page3-content">
            <h3>ACTIVIDADES DE LAS SEMANAS DE AVANCE</h3>
            <table>
              <tr>
                <th>ACTIVIDADES</th>
                <th>DESCRIPCI√ìN DE LA ACTIVIDAD</th>
                <th>FECHA DE ENTREGA</th>
              </tr>
              <tr>
                <td>PR√ÅCTICO I
                  20 puntos actividad pr√°ctica o cuestionario
                  </td>
                <td>De acuerdo a la complejidad se sugiere un plazo m√≠nimo de 7 a 10 d√≠as, 5 d√≠as visibles para el alumno los otros 5 se ir√°n dosificando con coordinaci√≥n acad√©mica para efectivizar la presentaci√≥n de las mismas con colaboraci√≥n con el departamento de seguimiento</td>
                <td><span id="fechaEntrega0" class="data-field"></span></td>
              </tr>
              <tr>
                <td>PR√ÅCTICO II
                  10 puntos foro
                  6 d√≠as 
                  </td>
                <td>El foro se caracteriza por generar interacci√≥n y un sano intercambio de conocimientos en el grupo y ampliando el panorama de todos los participantes. 
                  Ser√° visible 3 d√≠as para los participantes y los otros 3 se ir√°n dosificando con coordinaci√≥n acad√©mica para efectivizar la presentaci√≥n de las mismas con colaboraci√≥n con el departamento de seguimiento
                  </td>
                <td><span id="fechaEntrega1" class="data-field"></span></td>
              </tr>
              <tr>
                <td>ASISTENCIA, PARTICIPACI√ìN Y ENCUESTA DE SATISFACCI√íN
                  10 PUNTOS
                  </td>
                <td>De acuerdo a lo considerado por el docente </td>
                <td><span id="fechaEntrega2" class="data-field"></span></td>
              </tr>
              <tr>
                <td>CLASE O FORO PARA ACLARAR DUDAS √öLTIMO S√ÅBADO DEL M√ìDULO  </td>
                <td>De 19 a 21:00 pm</td>
                <td><span id="fechaEntrega3" class="data-field"></span></td>
              </tr>
              <tr>
                <td>TRABAJO FINAL DE M√ìDULO
                  60 PUNTOS
                  </td>
                <td>Ser√° visible para los participantes desde el inicio y como fin 7 d√≠as despu√©s de la √∫ltima actividad   y los otros d√≠as se ir√°n dosificando con coordinaci√≥n acad√©mica para efectivizar la presentaci√≥n de las mismas en colaboraci√≥n con el departamento de seguimiento </td>
                <td><span id="fechaEntrega4" class="data-field"></span></td>
              </tr>
              <tr>
                <td>ENTREGA DE NOTAS</td>
                <td>El docente debe entregar las calificaciones firmadas</td>
                <td><span id="fechaEntrega5" class="data-field"></span></td>
              </tr>
              <tr>
                <td>TRABAJO NIVELACI√ìN / RECUPERATORIO</td>
                <td>El docente debe entregar las calificaciones firmadas, con la retroalimentaci√≥n respectiva en plataforma para poder habilitar el recuperatorio</td>
                <td><span id="fechaEntrega6" class="data-field"></span></td>
              </tr>
              <tr>
                <td>TRABAJO NIVELACI√ìN / RECUPERATORIO 
                  71 PUNTOS 
                  </td>
                <td>Trabajo para nivelar el proceso formativo una actividad de las antes presentadas </td>
                <td><span id="fechaEntrega7" class="data-field"></span></td>
              </tr>
              <tr>
                <td>ENTREGA DE NOTAS DE RECUPERATORIO</td>
                <td>
                  El docente debe entregar las calificaciones 
                  </td>
                <td><span id="fechaEntrega8" class="data-field"></span></td>
              </tr>
              <tr>
                <td>RECUPERATORIO EMERGENTE 
                  CUESTIONARIO SE CALIFIQUE DE FORMA AUTOM√ÅTICA 
                  71 PUNTOS 
                  </td>
                <td>
                  Un cuestionario con 2 intentos que se califique de manera autom√°tica vencimiento 3 d√≠as
                  </td>
                <td><span id="fechaEntrega9" class="data-field"></span></td>
              </tr>
            </table><br>
            <p style="text-align: justify">
              Las tareas deben tener un plazo m√≠nimo de 7 a 9 d√≠as y para dar el tiempo suficiente a cada participante de realizar la misma y poder reforzar lo aprendido viendo los videos de las grabaciones, de esta manera el √°rea acad√©mica puede realizar el seguimiento correspondiente a los participantes.
              Usted como docente debe informar mediante el grupo de WhatsApp al momento en el que habilita una actividad en la plataforma, las actividades deben tener como hora de finalizaci√≥n las 23:59pm.
              Las calificaciones se deben registrar por su persona en nuestra Plataforma Virtual, de forma obligatoria, debiendo, adem√°s, enviar la planilla de notas firmada por su persona; en un plazo hasta 7 d√≠as luego de culminadas las sesiones sincr√≥nicas y la √∫ltima fecha de presentaci√≥n de actividades.
            </p><br><br><br>
            <p style="text-align: justify;">
              <strong>PARA LAS CLASES DE ZOOM:</strong><br>
              Debe ingresar 5 minutos antes. El fondo de Zoom (facilitado por coordinaci√≥n acad√©mica) puede descargarse desde el siguiente enlace:<br>
              <a href="https://drive.google.com/drive/folders/1joCN0UZQeccV5ZUFDncBzKbmVwrIGQPk?usp=sharing" target="_blank">Descargar fondo de Zoom</a><br><br>
              <strong>Requisitos:</strong><br>
              <ul style="list-style-position: inside;">
                  <li>Nombre completo; c√°mara prendida durante toda la sesi√≥n.</li>
                  <li>El descanso o receso no debe superar los 15 minutos y debe ser informado por el chat de Zoom.</li>
              </ul>
          </p>
          <p style="text-align: justify">
            <strong>Cabe mencionar que todas las clases deben ser grabadas de principio a fin.
              Es fundamental que la grabaci√≥n se mantenga en curso sin interrupciones, es importante contar con el respaldo de la grabaci√≥n como medida de seguridad y para garantizar la integridad del proceso formativo. y poder mantener como respaldo para aquellos alumnos que, por factores externos, no puedan acceder a la sesi√≥n en tiempo real. Esta medida asegura la continuidad del aprendizaje y permite a los estudiantes revisar el contenido.
              </strong>
          </p>

            <p style="text-align: justify">
            <p style="text-align: justify">
              <strong>EN CUANTO A HONORARIOS</strong> se cancelar√° el monto por el m√≥dulo completo 1.775 Bs.- (MONTO FACTURADO)
            </p><br>
            <p style="text-align: justify">
              <strong>NOTA:</strong>Este monto va a variar dependiendo del aumento del alumnado si supera los 41 participantes.
            </p>
            <p style="text-align: justify">
              <strong>-Servicios de ense√±anza</strong>
            </p>
            <p style="text-align: justify">
              <strong>-Servicios de ense√±anza</strong>
            </p>
            <p style="text-align: justify">
              <strong>DEBE TENER CUENTA HABILITADA EN BANCO BISA PARA EL ABONO DE HONORARIOS</strong>
            </p>
            <p style="text-align: justify;">
              El tiempo de presentaci√≥n de notas es de 5 d√≠as despu√©s de la conclusi√≥n del proceso formativo del respectivo m√≥dulo (para la delimitaci√≥n del recuperatorio). Dicho recuperatorio deber√° realizarse como m√≠nimo 5 d√≠as despu√©s para el acceso oportuno de los participantes. El horario l√≠mite ser√° a las 23:59 PM.
          </p>
          
          <p style="text-align: justify;">
              Finalmente, el docente debe presentar las <strong>Notas</strong> m√°s el <strong>Recuperatorio</strong> y el respectivo informe acad√©mico firmado de manera f√≠sica y/o digital. Estos deben enviarse a la siguiente direcci√≥n de correo electr√≥nico: 
              <a href="mailto:lucia.aramayo@esam.edu.bo">lucia.aramayo@esam.edu.bo</a> y tambi√©n a trav√©s de WhatsApp al n√∫mero 
              <a href="https://wa.me/59173360695" target="_blank">73360695</a> para el pago correspondiente.
          </p>
          
          <p style="text-align: justify;">
              Para estar dentro de la planilla de pagos del mes, debe presentar todo el informe, incluidas las notas de recuperatorio, como m√°ximo 7 d√≠as despu√©s del recuperatorio. Para el pago de honorarios, las notas completas (incluido el recuperatorio) y el material deben enviarse hasta el d√≠a 3 del respectivo mes, para su revisi√≥n y correcci√≥n. 
          </p>
          <p style="text-align: justify;">
              Caso contrario, su pago ser√° transferido para la cancelaci√≥n el pr√≥ximo mes.
          </p>
          <p style="text-align: justify;">
            La fecha de pago queda entre el 20 al 31 del mes en curso siempre y cuando cumpla con el requisito indispensable de presentar las notas completas incluido recuperatorio y material firmado hasta fecha 3 del respectivo mes.</p>

          <p style="text-align: justify;">
              Recordarle que su Informe firmado para el cierre del m√≥dulo, debe contemplar:
          </p>
          
          <ol style="text-align: justify; padding-left: 40px;">
              <li><strong>Informe de Conclusi√≥n del Desarrollo del M√≥dulo Plan Acad√©mico Curricular</strong></li>
              <li><strong>Acta de Notas Finales</strong></li>
              <li><strong>Resultados de la Ejecuci√≥n del M√≥dulo</strong></li>
              <li><strong>Planilla de Notas Incluido Recuperatorio, Firmado a Pie de P√°gina por Usted como Respaldo de la Misma. (Previamente las Notas Subidas a la Plataforma)</strong></li>
          </ol>
            <br><br><br><br><br><br><br><br><br><br>
          <p style="text-align: justify;">
            <strong>NOTA.</strong>- La empresa no es partidaria de temas pol√≠ticos, por ende, se proh√≠be al plantel docente mencionar estos elementos dentro del proceso formativo.
        </p>
        <p style="text-align: justify;">
          En caso de que surja alg√∫n inconveniente que impida su presencia en el desarrollo del m√≥dulo, deber√° notificar con antelaci√≥n y otorgar un reemplazo de grado acad√©mico igual o superior al suyo, con el fin de velar la calidad acad√©mica que la Instituci√≥n imparte a los posgraduantes, siempre previa autorizaci√≥n de coordinaci√≥n acad√©mica.
         </p>
          <p style="text-align: justify">
            <strong>Las clases, d√≠as y horarios no pueden ser sujetos a modificaci√≥n alguna excepto por feriados establecidos.
            Sin embargo, si el docente considera necesario pasar clases adicionales ser√°n organizadas junto a coordinaci√≥n acad√©mica pero no ser√°n retribuidas monetariamente</strong>         
          </p>
            <p style="text-align: justify">
              <strong
                >Sin otro particular y dese√°ndole √©xito en las funciones que desempe√±a me despido de la manera m√°s atenta y cordial.</strong
              ><br/>
              <p style="text-align: justify;">
                Esperando contar nuevamente con su presencia en futuros y pr√≥ximos programas.
             </p>
              
            
             <div style="text-align: center; width: 100%; margin-top: 50px; position: relative;">

              <!-- Contenedor para la imagen centrada -->
              <div style="text-align: center;">
                <!-- Firma (Imagen de la firma) centrada -->
                <img src="https://i.ibb.co/xtXh5YD2/firma.png" alt="firma" style="width: 120px; margin-bottom: 1%;">

                <!-- Informaci√≥n centrada -->
                <p style="margin: 0; font-size: 14px; line-height: 1.8; text-align: center;">
                    <strong><em>Ing. Andrea Luc√≠a Aramayo Mart√≠nez</em></strong><br />
                    <strong><em>COORDINADORA ACAD√âMICA</em></strong><br />
                    <strong><em>ESAM MONTEAGUNDO</em></strong><br />
                   <em>Cel: 73360695</em>
                </p>
              </div>

            
              <!-- Sello flotante a la derecha de la firma -->
              <img src="https://i.ibb.co/j2B0MBm/cello-final.png" alt="cello" style="position: absolute; top: 0; right: 0; width: 152px;">
            </div>
            
            <p>Deber√° enviar su Hoja de Vida documentada para derivar a la Universidad Nacional Siglo XX, que deber√° presentar en f√≠sico al Departamento Acad√©mico</p>
          </div>
        </div>
      </div>
    </div>

    <script>
    // Mostrar formulario de correo
    document.getElementById('btnCorreo').addEventListener('click', function(e) {
    const urlCompartir = document.getElementById('btnCompartir').getAttribute('data-url');
    const emailForm = document.getElementById('emailForm');
    
    if (!urlCompartir) {
        alert("Primero genera un documento con el bot√≥n PROCESAR");
        return;
    }

    // Posicionar el formulario
    const rect = this.getBoundingClientRect();
    emailForm.style.left = `${rect.left}px`;
    emailForm.style.top = `${rect.bottom + 10}px`;
    
    emailForm.classList.remove('hidden');
    document.getElementById('emailInput').focus();
});



















// funcion del correco electrnico
function enviarCorreo() {
    const email = document.getElementById('emailInput').value;
    const urlCompartir = document.getElementById('btnCompartir').getAttribute('data-url');
    
    if (!email || !email.includes('@') || !email.includes('.')) {
        alert("Ingrese un correo v√°lido");
        return;
    }

    // 1. Crear contenido del correo con formato profesional
    const cuerpo = `
        -----------------------------------------------
        |            ESCUELA DE NEGOCIOS ESAM          |
        |         SUCURSAL SUCRE - BOLIVIA             |
        -----------------------------------------------
        
        *Diplomado:* ${document.getElementById('inputDiplomado').value}
        *M√≥dulo:* ${document.getElementById('inputModulo').value}
        *Fecha de generaci√≥n:* ${new Date().toLocaleDateString()}
        
        ==============================================
        ENLACE AL DOCUMENTO:
        ${urlCompartir}
        ==============================================
        
        Instrucciones:
        1. Haga clic en el enlace superior
        2. El documento incluye 3 p√°ginas con toda la informaci√≥n
        3. Descargue el PDF usando el bot√≥n correspondiente
        
        -----------------------------------------------
        Contacto: coordinacion@esam.edu.bo | Tel: +591 12345678
        Direcci√≥n: Calle Sucre #976, Sucre, Bolivia
        -----------------------------------------------
    `;

    // 2. Codificar y acortar URL visualmente
    const cuerpoCodificado = encodeURIComponent(cuerpo)
        .replace(/%25E2%2594%2580/g, '-') // Mejorar legibilidad
        .replace(/%20/g, ' ');

    // 3. Abrir Gmail con par√°metros
    const mailtoLink = `https://mail.google.com/mail/?view=cm&fs=1&to=${email}&su=Documento%20Oficial%20ESAM&body=${cuerpoCodificado}`;
    
    // 4. Abrir en ventana optimizada
    window.open(mailtoLink, '_blank', 'width=800,height=600');
    
    // 5. Limpiar formulario
    document.getElementById('emailForm').classList.add('hidden');
    document.getElementById('emailInput').value = '';
}










      // Funci√≥n para formatear la fecha actual en espa√±ol
      function getFormattedDate() {
        const date = new Date();
        const day = date.getDate();
        const monthNames = [
          "enero",
          "febrero",
          "marzo",
          "abril",
          "mayo",
          "junio",
          "julio",
          "agosto",
          "septiembre",
          "octubre",
          "noviembre",
          "diciembre",
        ];
        const month = monthNames[date.getMonth()];
        const year = date.getFullYear();
        return `Sucre, ${day} de ${month} del ${year}`;
      }

      // Si no viene "view=doc", asigna la fecha actual
      if (!window.location.search.includes("view=doc")) {
        document.getElementById("fechaActual").textContent = getFormattedDate();
      }

      // Funci√≥n para obtener par√°metros de la URL
      function getURLParams() {
        const params = new URLSearchParams(window.location.search);
        const data = {};
        for (const [key, value] of params.entries()) {
          data[key] = decodeURIComponent(value);
        }
        return data;
      }

      // Si la URL tiene ?view=doc, cargar en modo solo visualizaci√≥n
      (function checkViewMode() {
    const params = getURLParams();
    if (params.view && params.view === "doc") {
        // Ocultar elementos no necesarios
        document.getElementById("loginContainer").style.display = "none";
        document.getElementById("formulario").classList.add("hidden");
        document.getElementById("botones-acciones").classList.add("hidden");
        
        // Mostrar documento
        document.getElementById("mainContainer").style.display = "block";
        document.getElementById("documento").style.display = "block";
        
        // Configurar bot√≥n de descarga
        const btnDescargar = document.getElementById("btnDescargarShared");
        if (btnDescargar) {
            btnDescargar.classList.remove("hidden");
            btnDescargar.onclick = () => {
                window.print(); // Funci√≥n de descarga
            };
        }

        // Cargar datos desde par√°metros URL
        if (params.msc) document.getElementById("mscNameOutput").textContent = params.msc;
        if (params.dip) {
            document.getElementById("diplomadoOutput").textContent = params.dip;
            document.getElementById("diplomadoOutput2").textContent = params.dip;
        }
        if (params.mod) document.getElementById("moduloOutput").textContent = params.mod;
        if (params.num) document.getElementById("numeroModuloOutput").textContent = params.num;
        if (params.cont) document.getElementById("contenidoOutput").textContent = params.cont;
        if (params.fchas) document.getElementById("fechasOutput").textContent = params.fchas;

        // Cargar fechas de entrega
        for (let i = 0; i < 10; i++) {
            const key = "fecha" + i;
            const el = document.getElementById("fechaEntrega" + i);
            if (el && params[key]) el.textContent = params[key];
        }

        // Fecha actual
        document.getElementById("fechaActual").textContent = getFormattedDate();
    }
})();
      // Generar 10 campos para fechas de entrega en el formulario
  const fechasContainer = document.getElementById("fechasContainer");
  for (let i = 0; i < 10; i++) {
    // Crear etiqueta
    const label = document.createElement("label");
    label.textContent = `Fecha de entrega ${i + 1}:`;
    label.setAttribute('for', `inputFechaEntrega${i}`);

    // Crear input tipo date
    const input = document.createElement("input");
    input.type = "date";
    input.id = `inputFechaEntrega${i}`;
    input.name = `inputFechaEntrega${i}`;
    input.classList.add("form-control", "mb-2");

    // Establecer la fecha actual por defecto
    const hoy = new Date().toISOString().split('T')[0];
    input.value = hoy;

    // A√±adir al contenedor
    fechasContainer.appendChild(label);
    fechasContainer.appendChild(input);
  }

      // LOGIN
      btnLogin.addEventListener("click", () => {
        const user = document.getElementById("username").value;
        const pass = document.getElementById("password").value;
        // Usuarios v√°lidos: usuario1/pass1 y usuario2/pass2
        if (
          (user === "usuario1" && pass === "pass1") ||
          (user === "admin" && pass === "admin123") ||
          (user === "jquintanacutipa" && pass === "10381927Ch") ||
          (user === "usuario1" && pass === "usuario1") ||
          (user === "usuario2" && pass === "pass2")
        ) {
          document.getElementById("loginContainer").style.display = "none";
          document.getElementById("mainContainer").style.display = "block";
        } 
      });

      // Referencias a botones y secciones del main
      const btnProcesar = document.getElementById("btnProcesar");
      const btnVer = document.getElementById("btnVer");
      const btnDescargar = document.getElementById("btnDescargar");
      const btnCompartir = document.getElementById("btnCompartir");
      const btnHistorial = document.getElementById("btnHistorial");
      const procesoMensaje = document.getElementById("procesoMensaje");
      const formulario = document.getElementById("formulario");
      const botonesAcciones = document.getElementById("botones-acciones");
      const documento = document.getElementById("documento");
      const historyContainer = document.getElementById("historyContainer");
      const historyList = document.getElementById("historyList");
      const btnCerrarHistorial = document.getElementById("btnCerrarHistorial");

      // Referencias a campos del formulario
      const inputMscName = document.getElementById("inputMscName");
      const inputDiplomado = document.getElementById("inputDiplomado");
      const inputModulo = document.getElementById("inputModulo");
      const inputNumeroModulo = document.getElementById("inputNumeroModulo");
      const inputContenido = document.getElementById("inputContenido");
      const inputFechas = document.getElementById("inputFechas");

      // Referencias a elementos donde se muestra la info en el documento
      const mscNameOutput = document.getElementById("mscNameOutput");
      const diplomadoOutput = document.getElementById("diplomadoOutput");
      const diplomadoOutput2 = document.getElementById("diplomadoOutput2");
      const moduloOutput = document.getElementById("moduloOutput");
      const numeroModuloOutput = document.getElementById("numeroModuloOutput");
      const contenidoOutput = document.getElementById("contenidoOutput");
      const fechasOutput = document.getElementById("fechasOutput");

      // Al hacer click en "PROCESAR" (5 segundos)
      btnProcesar.addEventListener("click", () => {
        if (
          !inputMscName.value ||
          !inputDiplomado.value ||
          !inputModulo.value
        ) {
          alert("Por favor, llena los campos obligatorios.");
          return;
        }
        procesoMensaje.classList.remove("hidden");
        btnProcesar.disabled = true;

        setTimeout(() => {
          mscNameOutput.textContent = inputMscName.value || "MSC. XX";
          diplomadoOutput.textContent =
            inputDiplomado.value || "DIPLOMADO EN XX";
          diplomadoOutput2.textContent =
            inputDiplomado.value || "DIPLOMADO EN XX";
          moduloOutput.textContent = inputModulo.value || "M√ìDULO EJEMPLO";
          numeroModuloOutput.textContent = inputNumeroModulo.value || "I";
          contenidoOutput.textContent =
            inputContenido.value || "CONTENIDO M√çNIMO SUGERIDO";
          fechasOutput.textContent =
            inputFechas.value || "Fecha de claces";

          document.getElementById("fechaActual").textContent =
            getFormattedDate();

          let fechaParams = "";
          for (let i = 0; i < 10; i++) {
            const fechaInput = document.getElementById(`inputFechaEntrega${i}`);
            const fechaOutput = document.getElementById(`fechaEntrega${i}`);
            let valor = fechaInput.value || "";
            if (fechaOutput) {
              fechaOutput.textContent = valor;
            }
            fechaParams += `&fecha${i}=` + encodeURIComponent(valor);
          }

          const baseUrl = window.location.origin + window.location.pathname;
          const urlCompartir = `${baseUrl}?view=doc&msc=${encodeURIComponent(
            inputMscName.value
          )}&dip=${encodeURIComponent(
            inputDiplomado.value
          )}&mod=${encodeURIComponent(
            inputModulo.value
          )}&num=${encodeURIComponent(
            inputNumeroModulo.value
          )}&cont=${encodeURIComponent(
            inputContenido.value
          )}&fchas=${encodeURIComponent(inputFechas.value)}${fechaParams}`;
          btnCompartir.setAttribute("data-url", urlCompartir);

          // Guardar en historial en localStorage
          const docEntry = {
            timestamp: new Date().toISOString(),
            url: urlCompartir,
          };
          let history = JSON.parse(localStorage.getItem("docHistory")) || [];
          history.push(docEntry);
          localStorage.setItem("docHistory", JSON.stringify(history));

          formulario.classList.add("hidden");
          procesoMensaje.classList.add("hidden");
          documento.style.display = "block";
          botonesAcciones.classList.remove("hidden");
        }, 5000);
      });

      // Bot√≥n Ver / Ocultar Documento
      let visible = true;
      btnVer.addEventListener("click", () => {
        visible = !visible;
        documento.style.display = visible ? "block" : "none";
      });

      // Bot√≥n Descargar (window.print para PDF)
      btnDescargar.addEventListener("click", () => {
        window.print();
      });

      // Bot√≥n Compartir Link: copia URL generada al portapapeles
      btnCompartir.addEventListener("click", () => {
        const url = btnCompartir.getAttribute("data-url");
        navigator.clipboard
          .writeText(url)
          .then(() => {
            alert("¬°Enlace copiado!");
          })
          .catch((err) => {
            alert("Error al copiar el enlace.");
          });
      });

      // Bot√≥n Historial: muestra el historial de documentos generados
      btnHistorial.addEventListener("click", () => {
        const history = JSON.parse(localStorage.getItem("docHistory")) || [];
        historyList.innerHTML = "";
        if (history.length === 0) {
          historyList.innerHTML = "<p>No hay documentos generados.</p>";
        } else {
          history.reverse().forEach((doc, index) => {
            const item = document.createElement("div");
            item.classList.add("history-item");
            const date = new Date(doc.timestamp);
            item.innerHTML = `<span>${date.toLocaleString()}</span>
          <button class="btn" onclick="verDocumentoHist('${
            doc.url
          }')">VER</button>`;
            historyList.appendChild(item);
          });
        }
        historyContainer.classList.remove("hidden");
      });

      // Funci√≥n para ver documento del historial
      function verDocumentoHist(url) {
        window.location.href = url;
      }

      // Bot√≥n para cerrar historial
      btnCerrarHistorial.addEventListener("click", () => {
        historyContainer.classList.add("hidden");
      });
    </script>
  </body>
</html>

<script src="https://unpkg.com/lucide@latest"></script>
<script>
  lucide.createIcons();
</script>
